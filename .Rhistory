return(graft)
}
graficaCurva(data_creGlu)
graficaCurva <- function(df){
df %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = Sustrato/100, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Sustrato/100, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ .  * 100, name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange")) -> graft
return(graft)
}
graficaCurva(data_creGlu)
graficaCurva <- function(df){
df %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = Sustrato/10, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Sustrato/10, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ .  * 10, name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange")) -> graft
return(graft)
}
graficaCurva(data_creGlu)
graficaCurva(data_creAlm)
View(data_creAlm)
graficaCurva <- function(df){
df %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = Sustrato/1000, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Sustrato/1000, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ .  * 1000, name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange")) -> graft
return(graft)
}
graficaCurva(data_creAlm)
graficaCurva <- function(df){
df %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = Sustrato/100, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Sustrato/100, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ .  * 100, name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange")) -> graft
return(graft)
}
graficaCurva(data_creAlm)
graficaCurva <- function(df){
df %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = Sustrato/100, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Sustrato/100, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ .  * 10, name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange")) -> graft
return(graft)
}
graficaCurva(data_creAlm)
graficaCurva <- function(df){
df %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = Sustrato/10, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Sustrato/10, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ .  * 10, name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange")) -> graft
return(graft)
}
graficaCurva(data_creAlm)
graficaCurva <- function(df){
df %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = Sustrato/100, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Sustrato/100, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ .  * 10, name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange")) -> graft
return(graft)
}
graficaCurva(data_creAlm)
graficaCurva <- function(df){
df %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = Sustrato/100, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Sustrato/100, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ .  * 100, name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange")) -> graft
return(graft)
}
graficaCurva(data_creAlm)
graficaCurva <- function(df){
df %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = Sustrato/10, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Sustrato/10, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ .  * 10, name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange")) -> graft
return(graft)
}
graficaCurva(data_creAlm)
dfout  %>%
ggplot(aes(x = time)) +
geom_smooth(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = S/5000, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = S/5000, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ . * 1000, name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange"))
write.csv(dfout, file = "data_modelada.csv")
dfout
data_creGlu
dfout$Biomasa
data_creGlu$Biomasa
data_creGlu
data_creGlu %>%
group_by(Time) %>%
reframe(mean_biomasa = mean(Biomasa))
data_creGlu %>%
group_by(Time) %>%
reframe(mean_biomasa = mean(Biomasa)) %>%
mutate(Biomasa_sim = dfout$Biomasa)
data_creGlu %>%
group_by(Time) %>%
reframe(Biomasa_exp = mean(Biomasa)) %>%
mutate(Biomasa_sim = dfout$Biomasa)  %>%
ggplot(aes(x = time)) +
geom_smooth(aes(y = Biomasa_exp, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa_exp, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = Biomasa_sim, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Biomasa_sim, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ . , name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange"))
data_creGlu %>%
group_by(Time) %>%
reframe(Biomasa_exp = mean(Biomasa)) %>%
mutate(Biomasa_sim = dfout$Biomasa)  %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa_exp, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa_exp, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = Biomasa_sim, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Biomasa_sim, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ . , name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange"))
data_creGlu %>%
group_by(Time) %>%
reframe(Biomasa_exp = mean(Biomasa)) %>%
mutate(Biomasa_sim = dfout$Biomasa)  %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa_exp, color = "Biomasa experimental(g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa_exp, color = "Biomasa experimental (g/L)"), size = 2) +
geom_smooth(aes(y = Biomasa_sim, color = "Biomasa simulada (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Biomasa_sim, color = "Biomasa simulada (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ . , name = "Biomasa simulada (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa experimental(g/L)" = "blue", "Biomasa simulada (g/L)" = "orange"))
data_creGlu %>%
group_by(Time) %>%
reframe(Biomasa_exp = mean(Biomasa)) %>%
mutate(Biomasa_sim = dfout$Biomasa)  %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa_exp, color = "Biomasa experimental (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa_exp, color = "Biomasa experimental (g/L)"), size = 2) +
geom_smooth(aes(y = Biomasa_sim, color = "Biomasa simulada (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Biomasa_sim, color = "Biomasa simulada (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ . , name = "Biomasa simulada (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa experimental (g/L)" = "blue", "Biomasa simulada (g/L)" = "orange"))
data_ES <- data_creGlu %>%
group_by(Time) %>%
reframe(Biomasa_exp = mean(Biomasa)) %>%
mutate(Biomasa_sim = dfout$Biomasa)
data_ES %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa_exp, color = "Biomasa experimental (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa_exp, color = "Biomasa experimental (g/L)"), size = 2) +
geom_smooth(aes(y = Biomasa_sim, color = "Biomasa simulada (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Biomasa_sim, color = "Biomasa simulada (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ . , name = "Biomasa simulada (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa experimental (g/L)" = "blue", "Biomasa simulada (g/L)" = "orange"))
chisq.test(data_ES)
chisq.test(data_ES[2:3])
data_ES[2:3]
chisq.test(data_ES[2:3])
prub_ajus <- chisq.test(data_ES[2:3])
prub_ajus
prub_ajus$observed
prub_ajus$expected
prub_ajus <- chisq.test(t(data_ES[2:3]))
prub_ajus$expected
prub_ajus$p
prub_ajus
prub_ajus <- chisq.test(t(data_ES[2:3]))
prub_ajus
t(data_ES[2:3]
t(data_ES[2:3])
t(data_ES[2:3])
data_ES[2:3]
data_ES[2:3] %>%
mutate(X = ((Biomasa_exp - Biomasa_sim)^2)/Biomasa_sim)
chist <- data_ES[2:3] %>%
mutate(X = ((Biomasa_exp - Biomasa_sim)^2)/Biomasa_sim)
sum(chist$X)
pchisq(sum(chist$X), df = 8, lower.tail = F)
pchisq(sum(chist$X), df = 2, lower.tail = F)
pchisq(sum(chist$X), df = 1, lower.tail = F)
pchisq(sum(chist$X), df = 3, lower.tail = F)
pchisq(sum(chist$X), df = 8, lower.tail = F)
library(tidyverse)
library(ggpmisc)
data_exp <- read_excel("Tablas.xlsx", sheet = "FC")
library(readxl)
data_exp <- read_excel("Tablas.xlsx", sheet = "FC")
data_exp %>%
gather(key = "DO", value = "Abs", 2:4) %>%
ggplot(aes(x =Conc, y = D.O.REAL)) +
geom_smooth(method = "lm", se = T) +
geom_point(aes(y = Abs)) +
stat_boxplot(aes(group = as.factor(Conc), y = Abs), geom = "errorbar") +
labs(y = "D.O 625 nm",
x = "Concentración Glucosa (mg/L) ") +
scale_x_continuous(breaks = seq(10, 100, 5)) +
stat_poly_eq(aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
formula = y ~ x, parse = TRUE, size = 5, color = "black")+
theme_classic()
data_cp <- read_excel("Tablas.xlsx", sheet = "CP")
data_cp[, c(2, 4, 5, 6, 8)] %>%
gather(key = "DO", value = "Abs", 2:4)  %>%
ggplot(aes(x =DB, y = D.O.REAL)) +
geom_smooth(method = "lm", se = T) +
geom_point(aes(y = Abs)) +
stat_boxplot(aes(group = as.factor(DB), y = Abs), geom = "errorbar", width = 0.04) +
labs(y = "D.O 620 nm",
x = "Dilucion Biomasa") +
stat_poly_eq(aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
formula = y ~ x, parse = TRUE, size = 5, color = "black")+
theme_classic()
data_cps <- read_excel("Tablas.xlsx", sheet = "CPS")
data_cps %>%
ggplot(aes(x =Biomasa, y = D.O.REAL)) +
geom_smooth(method = "lm", se = T) +
geom_point() +
labs(y = "D.O 620 nm",
x = "Biomasa (g/L) ") +
stat_poly_eq(aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
formula = y ~ x, parse = TRUE, size = 5, color = "black")+
theme_classic()
curva_biomasa <- lm(Biomasa ~ D.O.REAL, data = data_cps)
chist <- data_ES[2:3] %>%
mutate(X = (abs(Biomasa_exp - Biomasa_sim))/Biomasa_sim)
data_ES <- data_creGlu %>%
group_by(Time) %>%
reframe(Biomasa_exp = mean(Biomasa)) %>%
mutate(Biomasa_sim = dfout$Biomasa)
graficaCurva <- function(df){
df %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = Sustrato/10, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Sustrato/10, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ .  * 10, name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange")) -> graft
return(graft)
}
graficaCurva(data_creGlu)
data_sac <- read_excel("Tablas.xlsx", sheet = "Saca")
data_glu <- read_excel("Tablas.xlsx", sheet = "Gluc")
data_ara <- read_excel("Tablas.xlsx", sheet = "Ara")
data_alm <- read_excel("Tablas.xlsx", sheet = "Alm")
curva_biomasa <- lm(Biomasa ~ D.O.REAL, data = data_cps)
graficaCurva <- function(df){
df %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = Sustrato/10, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Sustrato/10, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ .  * 10, name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange")) -> graft
return(graft)
}
data_creGlu <- data_glu %>%
reframe(Time = Tiempo * 4,
DOR1 = DO1 * D,
DOR2 = DO2 * D,
DOR3 = DO3 * D,
Sustrato = Consumo/1000) %>%
gather(key = "DOReal", value = "Abs", 2:4) %>%
mutate(Biomasa = predict(curva_biomasa, newdata = data.frame(D.O.REAL = data_creGlu$Abs)))
data_creSac <- data_sac %>%
reframe(Time = Tiempo * 4,
DOR1 = DO1 * D,
DOR2 = DO2 * D,
DOR3 = DO3 * D,
Sustrato = Consumo/1000) %>%
gather(key = "DOReal", value = "Abs", 2:4) %>%
mutate(Biomasa = predict(curva_biomasa, newdata = data.frame(D.O.REAL = data_creSac$Abs)))
data_creAra <- data_ara %>%
reframe(Time = Tiempo * 4,
DOR1 = DO1 * D,
DOR2 = DO2 * D,
DOR3 = DO3 * D,
Sustrato = Consumo/1000) %>%
gather(key = "DOReal", value = "Abs", 2:4) %>%
mutate(Biomasa = predict(curva_biomasa, newdata = data.frame(D.O.REAL = data_creAra$Abs)))
data_creAlm <- data_alm %>%
reframe(Time = Tiempo * 4,
DOR1 = DO1 * D,
DOR2 = DO2 * D,
DOR3 = DO3 * D,
Sustrato = Consumo/1000) %>%
gather(key = "DOReal", value = "Abs", 2:4) %>%
mutate(Biomasa = predict(curva_biomasa, newdata = data.frame(D.O.REAL = data_creAlm$Abs)))
data_creGlu <- data_glu %>%
reframe(Time = Tiempo * 4,
DOR1 = DO1 * D,
DOR2 = DO2 * D,
DOR3 = DO3 * D,
Sustrato = Consumo/1000) %>%
gather(key = "DOReal", value = "Abs", 2:4) %>%
mutate(Biomasa = predict(curva_biomasa, newdata = data.frame(D.O.REAL = data_creGlu$Abs)))
data_creGlu <- data_glu %>%
reframe(Time = Tiempo * 4,
DOR1 = DO1 * D,
DOR2 = DO2 * D,
DOR3 = DO3 * D,
Sustrato = Consumo/1000) %>%
gather(key = "DOReal", value = "Abs", 2:4)
data_creGlu <- data_glu %>%
reframe(Time = Tiempo * 4,
DOR1 = DO1 * D,
DOR2 = DO2 * D,
DOR3 = DO3 * D,
Sustrato = Consumo/1000) %>%
gather(key = "DOReal", value = "Abs", 2:4) %>%
mutate(Biomasa = predict(curva_biomasa, newdata = data.frame(D.O.REAL = data_creGlu$Abs)))
data_ES <- data_creGlu %>%
group_by(Time) %>%
reframe(Biomasa_exp = mean(Biomasa)) %>%
mutate(Biomasa_sim = dfout$Biomasa)
library(deSolve)
circuits <- function(t, state, parameters){
with(as.list(c(state, parameters)),{
dN <- u * N * (1 - N/Nmax)
dS <- -N * Vmax * S/(Km+S)
return(list(c(dN, dS)))
})
}
t <- seq(0, 32, by = 4)
state <- c( N = 0.1, S = 111)
parameters <- c( u = 0.37, Nmax = 2.5, Vmax = 11, Km = 76)
output1 <- ode(circuits, times = t, y = state, parms = parameters)
dfout <- as.data.frame(output1)
dfout <- dfout %>%
mutate(Sutrato = S/5.55,
Biomasa = predict(curva_biomasa, newdata = data.frame(D.O.REAL = dfout$N)))
dfout  %>%
ggplot(aes(x = time)) +
geom_smooth(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa, color = "Biomasa (g/L)"), size = 2) +
geom_smooth(aes(y = S/5000, color = "Sustrato (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = S/5000, color = "Sustrato (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ . * 1000, name = "Sustrato (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa (g/L)" = "blue", "Sustrato (g/L)" = "orange"))
dfout$Biomasa
data_ES <- data_creGlu %>%
group_by(Time) %>%
reframe(Biomasa_exp = mean(Biomasa)) %>%
mutate(Biomasa_sim = dfout$Biomasa)
data_ES %>%
ggplot(aes(x = Time)) +
geom_smooth(aes(y = Biomasa_exp, color = "Biomasa experimental (g/L)"), size = 1, linetype = "dotted") +
geom_point(aes(y = Biomasa_exp, color = "Biomasa experimental (g/L)"), size = 2) +
geom_smooth(aes(y = Biomasa_sim, color = "Biomasa simulada (g/L)"), size = 1, linetype = "dashed") +  # Ajustar el Sustrato a escala
geom_point(aes(y = Biomasa_sim, color = "Biomasa simulada (g/L)"), size = 2) +  # Ajustar el Sustrato a escala
scale_y_continuous(
name = "Biomasa (g/L)",
sec.axis = sec_axis(~ . , name = "Biomasa simulada (g/L)")
) +
labs(x = "Tiempo (h)", color = "") +
theme_classic() +
theme(legend.position = "top") +
scale_color_manual(values = c("Biomasa experimental (g/L)" = "blue", "Biomasa simulada (g/L)" = "orange"))
chist <- data_ES[2:3] %>%
mutate(X = (abs(Biomasa_exp - Biomasa_sim))/Biomasa_sim)
pchisq(sum(chist$X), df = 8, lower.tail = F)
chist
chist <- data_ES[2:3] %>%
mutate(X = ((Biomasa_exp - Biomasa_sim))/Biomasa_sim)
chist
pchisq(sum(chist$X), df = 8, lower.tail = F)
chist$X
sum(chist$X)
